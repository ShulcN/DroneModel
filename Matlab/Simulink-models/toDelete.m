% Параметры системы
m = 1.0;       % масса (пример значения)
Ix = 1.0;      % момент инерции по X (пример)
Iy = 1.0;      % момент инерции по Y (пример)
Iz = 1.0;      % момент инерции по Z (пример)
g = 9.81;      % ускорение свободного падения
T = 1.0;       % тяга (пример)
A_ind = eye(3); % пример матрицы индуцированного сопротивления
A_flap = zeros(3); % пример матрицы сопротивления от закрылков

% Матрица Adrag
Adrag = -T/m * (A_ind + A_flap);

% Построение матрицы A
A = zeros(12);
A(1:3, 4:6) = eye(3);          % позиции -> скорости
A(4:6, 4:6) = Adrag;           % блок аэродинамического сопротивления
A(7:9, 7:9) = eye(3);          % блок интегральных состояний (пример)

% Построение матрицы B
B = zeros(12,4);
B(6, 1) = 1/m;                 % управление по оси Z
B(10, 2) = 1/Ix;               % управление по крену
B(11, 3) = 1/Iy;               % управление по тангажу
B(12, 4) = 1/Iz;               % управление по рысканью

% Определение весовых матриц LQR
Q = diag([10 10 10 1 1 1 5 5 5 1 1 1]); % веса состояний
R = eye(4);                             % веса управлений

% Синтез LQR-регулятора
[K, ~, ~] = lqr(A, B, Q, R);

% Вывод коэффициентов
disp('LQR коэффициенты регулятора:');
disp(K);